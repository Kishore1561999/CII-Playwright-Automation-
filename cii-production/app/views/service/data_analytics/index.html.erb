<% content_for :title, "Streamline Data Analytics with Easy Downloads" %>
<% content_for :description, "Analysts submit and extract raw data and analytics from Excel files, allowing user to easily download comprehensive data insights and reports" %>
<b style="color:#392675">Download Reports</b><br><br>
<div class="card">
  <div class="tab-content">
    <b style="color:#392675">Sector Specific</b><br><br>
    <div class="row">
      <div class="col-md-4">
        <select name="company_sector" id="company_sector" class="form-control form-select">
          <option value="">Select sector</option>
          <% Sector.all.each do |sector| %>
            <option value="<%= sector.sector_name %>"><%= sector.sector_name %></option>
          <% end %>
        </select>
      </div>
      <div class="col-md-4">
        <%= link_to "Download", "#", class: "btn btn-primary", id: "download-button" %>
      </div>
    </div><br><br>

    <b style="color:#392675">General Specific</b><br><br>
    <div class="row">
      <div class="col-md-4">
      <%= link_to "Download", download_analytics_general_specific_report_path(format: :xlsx), class: "btn btn-primary" %>
      </div>
    </div>
  </div>
</div>

<script>
 $(function () {
    var downloadButton = document.getElementById('download-button');
    var sectorSelect = document.getElementById('company_sector');

    sectorSelect.onchange = function() {
      var sectorId = encodeURIComponent(sectorSelect.value);
      var downloadUrl = "<%= download_analytics_sector_specific_report_path(format: :xlsx) %>?sector_id=" + sectorId;
      downloadButton.setAttribute('href', downloadUrl);
    };
  });
</script>
